{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"withCoalescedInvoke\", {\n  enumerable: true,\n  get: function () {\n    return withCoalescedInvoke;\n  }\n});\nconst globalInvokeCache = new Map();\nfunction withCoalescedInvoke(func) {\n  return async function (key, args) {\n    const entry = globalInvokeCache.get(key);\n    if (entry) {\n      return entry.then(res => ({\n        isOrigin: false,\n        value: res.value\n      }));\n    }\n    async function __wrapper() {\n      return await func.apply(undefined, args);\n    }\n    const future = __wrapper().then(res => {\n      globalInvokeCache.delete(key);\n      return {\n        isOrigin: true,\n        value: res\n      };\n    }).catch(err => {\n      globalInvokeCache.delete(key);\n      return Promise.reject(err);\n    });\n    globalInvokeCache.set(key, future);\n    return future;\n  };\n}","map":{"version":3,"names":["withCoalescedInvoke","globalInvokeCache","Map","func","key","args","entry","get","then","res","isOrigin","value","__wrapper","apply","undefined","future","delete","catch","err","Promise","reject","set"],"sources":["../../src/lib/coalesced-function.ts"],"sourcesContent":[null],"mappings":";;;;;+BASgB;;;WAAAA,mBAAA;;;AAFhB,MAAMC,iBAAA,GAAoB,IAAIC,GAAA;AAEvB,SAASF,oBACdG,IAAO;EAKP,OAAO,gBAAgBC,GAAW,EAAEC,IAAmB;IACrD,MAAMC,KAAA,GAAQL,iBAAA,CAAkBM,GAAG,CAACH,GAAA;IACpC,IAAIE,KAAA,EAAO;MACT,OAAOA,KAAA,CAAME,IAAI,CAAEC,GAAA,KAAS;QAC1BC,QAAA,EAAU;QACVC,KAAA,EAAOF,GAAA,CAAIE;MACb;IACF;IAEA,eAAeC,UAAA;MACb,OAAO,MAAMT,IAAA,CAAKU,KAAK,CAACC,SAAA,EAAWT,IAAA;IACrC;IAEA,MAAMU,MAAA,GAASH,SAAA,GACZJ,IAAI,CAAEC,GAAA;MACLR,iBAAA,CAAkBe,MAAM,CAACZ,GAAA;MACzB,OAAO;QAAEM,QAAA,EAAU;QAAMC,KAAA,EAAOF;MAAoC;IACtE,GACCQ,KAAK,CAAEC,GAAA;MACNjB,iBAAA,CAAkBe,MAAM,CAACZ,GAAA;MACzB,OAAOe,OAAA,CAAQC,MAAM,CAACF,GAAA;IACxB;IACFjB,iBAAA,CAAkBoB,GAAG,CAACjB,GAAA,EAAKW,MAAA;IAC3B,OAAOA,MAAA;EACT;AACF"},"metadata":{},"sourceType":"script","externalDependencies":[]}